// Dados das perguntas
const questionsData = {
    matematica: [
        {
            question: "Qual é o resultado de 15 + 28?",
            options: ["41", "43", "45", "47"],
            correct: 1,
            explanation: "15 + 28 = 43"
        },
        {
            question: "Se um triângulo tem ângulos de 60°, 60° e 60°, ele é:",
            options: ["Escaleno", "Isósceles", "Equilátero", "Retângulo"],
            correct: 2,
            explanation: "Um triângulo com todos os ângulos iguais a 60° é equilátero."
        },
        {
            question: "Qual é a raiz quadrada de 144?",
            options: ["10", "11", "12", "13"],
            correct: 2,
            explanation: "√144 = 12, pois 12 × 12 = 144"
        },
        {
            question: "Se x + 5 = 12, qual é o valor de x?",
            options: ["5", "6", "7", "8"],
            correct: 2,
            explanation: "x + 5 = 12, então x = 12 - 5 = 7"
        },
        {
            question: "Qual é a área de um retângulo com base 8 e altura 6?",
            options: ["42", "46", "48", "50"],
            correct: 2,
            explanation: "Área = base × altura = 8 × 6 = 48"
        },
        {
            question: "Quanto é 25% de 200?",
            options: ["25", "50", "75", "100"],
            correct: 1,
            explanation: "25% de 200 = 0,25 × 200 = 50"
        },
        {
            question: "Qual é o perímetro de um quadrado com lado 7 cm?",
            options: ["21 cm", "28 cm", "35 cm", "49 cm"],
            correct: 1,
            explanation: "Perímetro do quadrado = 4 × lado = 4 × 7 = 28 cm"
        },
        {
            question: "Se 3x = 21, qual é o valor de x?",
            options: ["6", "7", "8", "9"],
            correct: 1,
            explanation: "3x = 21, então x = 21 ÷ 3 = 7"
        },
        {
            question: "Qual é o resultado de 8²?",
            options: ["16", "32", "64", "128"],
            correct: 2,
            explanation: "8² = 8 × 8 = 64"
        },
        {
            question: "Em uma fração 3/4, qual é o denominador?",
            options: ["3", "4", "7", "12"],
            correct: 1,
            explanation: "Na fração 3/4, o denominador é 4 (número de baixo)."
        }
    ],
    geografia: [
        {
            question: "Qual é a capital do Brasil?",
            options: ["São Paulo", "Rio de Janeiro", "Brasília", "Salvador"],
            correct: 2,
            explanation: "Brasília é a capital federal do Brasil desde 1960."
        },
        {
            question: "Qual é o maior país do mundo em extensão territorial?",
            options: ["China", "Estados Unidos", "Canadá", "Rússia"],
            correct: 3,
            explanation: "A Rússia é o maior país do mundo com mais de 17 milhões de km²."
        },
        {
            question: "Em qual continente fica o Egito?",
            options: ["Ásia", "África", "Europa", "Oceania"],
            correct: 1,
            explanation: "O Egito está localizado no continente africano."
        },
        {
            question: "Qual é o rio mais longo do mundo?",
            options: ["Amazonas", "Nilo", "Mississippi", "Yangtzé"],
            correct: 1,
            explanation: "O Rio Nilo, com cerca de 6.650 km, é considerado o mais longo do mundo."
        },
        {
            question: "Quantos continentes existem?",
            options: ["5", "6", "7", "8"],
            correct: 2,
            explanation: "Existem 7 continentes: África, Antártida, Ásia, Europa, América do Norte, América do Sul e Oceania."
        },
        {
            question: "Qual é a capital da França?",
            options: ["Londres", "Madrid", "Paris", "Roma"],
            correct: 2,
            explanation: "Paris é a capital da França."
        },
        {
            question: "Qual é a montanha mais alta do mundo?",
            options: ["K2", "Monte Everest", "Kilimanjaro", "Mont Blanc"],
            correct: 1,
            explanation: "O Monte Everest, com 8.848 metros, é a montanha mais alta do mundo."
        },
        {
            question: "Em qual oceano fica a Ilha de Madagascar?",
            options: ["Atlântico", "Pacífico", "Índico", "Ártico"],
            correct: 2,
            explanation: "Madagascar está localizada no Oceano Índico, próxima à costa da África."
        },
        {
            question: "Qual país tem a maior população do mundo?",
            options: ["Índia", "China", "Estados Unidos", "Indonésia"],
            correct: 1,
            explanation: "A China tem a maior população do mundo, com mais de 1,4 bilhão de habitantes."
        },
        {
            question: "Qual é o menor país do mundo?",
            options: ["Mônaco", "Vaticano", "San Marino", "Liechtenstein"],
            correct: 1,
            explanation: "O Vaticano é o menor país do mundo, com apenas 0,44 km²."
        }
    ],
    historia: [
        {
            question: "Em que ano o Brasil foi descoberto pelos portugueses?",
            options: ["1498", "1500", "1502", "1504"],
            correct: 1,
            explanation: "O Brasil foi descoberto por Pedro Álvares Cabral em 22 de abril de 1500."
        },
        {
            question: "Quem foi o primeiro presidente do Brasil?",
            options: ["Getúlio Vargas", "Deodoro da Fonseca", "Floriano Peixoto", "Prudente de Morais"],
            correct: 1,
            explanation: "Deodoro da Fonseca foi o primeiro presidente do Brasil (1889-1891)."
        },
        {
            question: "Em que ano começou a Segunda Guerra Mundial?",
            options: ["1937", "1938", "1939", "1940"],
            correct: 2,
            explanation: "A Segunda Guerra Mundial começou em 1939 com a invasão da Polônia pela Alemanha."
        },
        {
            question: "Qual civilização construiu as pirâmides de Gizé?",
            options: ["Romana", "Grega", "Egípcia", "Mesopotâmica"],
            correct: 2,
            explanation: "As pirâmides de Gizé foram construídas pelos antigos egípcios."
        },
        {
            question: "Em que ano foi proclamada a Independência do Brasil?",
            options: ["1820", "1821", "1822", "1823"],
            correct: 2,
            explanation: "A Independência do Brasil foi proclamada em 7 de setembro de 1822."
        },
        {
            question: "Quem foi Napoleão Bonaparte?",
            options: ["Rei da França", "Imperador da França", "Presidente da França", "Duque da França"],
            correct: 1,
            explanation: "Napoleão Bonaparte foi Imperador da França de 1804 a 1814."
        },
        {
            question: "Em que século ocorreu o Renascimento?",
            options: ["Século XIII", "Século XIV", "Século XV", "Século XVI"],
            correct: 2,
            explanation: "O Renascimento ocorreu principalmente nos séculos XV e XVI."
        },
        {
            question: "Qual foi a primeira capital do Brasil?",
            options: ["Rio de Janeiro", "São Paulo", "Salvador", "Brasília"],
            correct: 2,
            explanation: "Salvador foi a primeira capital do Brasil, de 1549 a 1763."
        },
        {
            question: "Em que ano caiu o Muro de Berlim?",
            options: ["1987", "1988", "1989", "1990"],
            correct: 2,
            explanation: "O Muro de Berlim caiu em 9 de novembro de 1989."
        },
        {
            question: "Quem descobriu o Brasil?",
            options: ["Vasco da Gama", "Pedro Álvares Cabral", "Cristóvão Colombo", "Fernão de Magalhães"],
            correct: 1,
            explanation: "Pedro Álvares Cabral descobriu o Brasil em 1500."
        }
    ]
};

// Nomes das matérias
const subjectNames = {
    matematica: "Matemática",
    geografia: "Geografia",
    historia: "História"
};

// Estado do jogo
let currentSubject = '';
let currentQuestionIndex = 0;
let score = 0;
let selectedAnswer = null;
let questions = [];

// Elementos DOM
const homePage = document.getElementById('home-page');
const quizPage = document.getElementById('quiz-page');
const resultPage = document.getElementById('result-page');

// Inicialização
document.addEventListener('DOMContentLoaded', function() {
    initializeEventListeners();
});

function initializeEventListeners() {
    // Botões de iniciar quiz
    document.querySelectorAll('.subject-card').forEach(card => {
        card.addEventListener('click', function() {
            const subject = this.dataset.subject;
            startQuiz(subject);
        });
    });

    // Botões de navegação
    document.getElementById('home-btn').addEventListener('click', goHome);
    document.getElementById('home-result-btn').addEventListener('click', goHome);
    document.getElementById('retry-btn').addEventListener('click', retryQuiz);
    document.getElementById('next-btn').addEventListener('click', nextQuestion);
}

function startQuiz(subject) {
    currentSubject = subject;
    questions = [...questionsData[subject]];
    currentQuestionIndex = 0;
    score = 0;
    selectedAnswer = null;

    // Atualizar título do quiz
    document.getElementById('quiz-title').textContent = `Quiz de ${subjectNames[subject]}`;
    
    // Mostrar página do quiz
    showPage('quiz');
    
    // Carregar primeira pergunta
    loadQuestion();
}

function loadQuestion() {
    const question = questions[currentQuestionIndex];
    
    // Atualizar informações do progresso
    document.getElementById('question-counter').textContent = 
        `Pergunta ${currentQuestionIndex + 1} de ${questions.length}`;
    document.getElementById('score-display').textContent = 
        `Pontuação: ${score}/${currentQuestionIndex}`;
    
    // Atualizar barra de progresso
    const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
    document.getElementById('progress-fill').style.width = `${progress}%`;
    
    // Carregar pergunta
    document.getElementById('question-text').textContent = question.question;
    
    // Carregar opções
    const optionsContainer = document.getElementById('options-container');
    optionsContainer.innerHTML = '';
    
    question.options.forEach((option, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'option';
        optionElement.textContent = option;
        optionElement.addEventListener('click', () => selectAnswer(index));
        optionsContainer.appendChild(optionElement);
    });
    
    // Resetar estado
    selectedAnswer = null;
    document.getElementById('next-btn').disabled = true;
    document.getElementById('explanation-card').classList.add('hidden');
}

function selectAnswer(answerIndex) {
    if (selectedAnswer !== null) return; // Já respondeu
    
    selectedAnswer = answerIndex;
    const options = document.querySelectorAll('.option');
    const question = questions[currentQuestionIndex];
    
    // Marcar todas as opções como desabilitadas
    options.forEach(option => option.classList.add('disabled'));
    
    // Marcar resposta selecionada
    options[answerIndex].classList.add('selected');
    
    // Mostrar resposta correta
    options[question.correct].classList.add('correct');
    
    // Se errou, marcar como incorreta
    if (answerIndex !== question.correct) {
        options[answerIndex].classList.add('incorrect');
    }
    
    // Mostrar explicação
    showExplanation(answerIndex === question.correct);
    
    // Habilitar botão próxima
    document.getElementById('next-btn').disabled = false;
}

function showExplanation(isCorrect) {
    const explanationCard = document.getElementById('explanation-card');
    const resultIcon = document.getElementById('result-icon');
    const resultTitle = document.getElementById('result-title');
    const explanationText = document.getElementById('explanation-text');
    const question = questions[currentQuestionIndex];
    
    // Configurar ícone e título
    if (isCorrect) {
        resultIcon.className = 'fas fa-check-circle';
        resultIcon.parentElement.classList.remove('incorrect');
        resultTitle.textContent = 'Correto!';
        score++;
    } else {
        resultIcon.className = 'fas fa-times-circle';
        resultIcon.parentElement.classList.add('incorrect');
        resultTitle.textContent = 'Incorreto!';
    }
    
    // Mostrar explicação
    explanationText.textContent = question.explanation;
    explanationCard.classList.remove('hidden');
}

function nextQuestion() {
    if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        loadQuestion();
    } else {
        showResults();
    }
}

function showResults() {
    const finalScore = document.getElementById('final-score');
    const percentage = document.getElementById('percentage');
    const scoreMessage = document.getElementById('score-message');
    
    // Calcular porcentagem
    const percentValue = Math.round((score / questions.length) * 100);
    
    // Atualizar elementos
    finalScore.textContent = `${score}/${questions.length}`;
    percentage.textContent = `${percentValue}% de acertos`;
    
    // Mensagem baseada na performance
    let message = '';
    if (percentValue >= 80) {
        message = 'Excelente! Você domina o assunto!';
    } else if (percentValue >= 60) {
        message = 'Muito bem! Bom conhecimento!';
    } else if (percentValue >= 40) {
        message = 'Razoável. Continue estudando!';
    } else {
        message = 'Precisa estudar mais. Não desista!';
    }
    
    scoreMessage.textContent = message;
    
    // Mostrar página de resultado
    showPage('result');
}

function retryQuiz() {
    startQuiz(currentSubject);
}

function goHome() {
    showPage('home');
}

function showPage(pageId) {
    // Esconder todas as páginas
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });
    
    // Mostrar página específica
    if (pageId === 'home') {
        homePage.classList.add('active');
    } else if (pageId === 'quiz') {
        quizPage.classList.add('active');
    } else if (pageId === 'result') {
        resultPage.classList.add('active');
    }
}
